---
layout: default
title: "computer-network è®¡ç®—æœºç½‘ç»œ"
date:   2024-04-30 13:27:58 +0800
categories: [update,Network] 
---
#	è®¡ç®—æœºç½‘ç»œæ¨¡å‹
  1.[åº”ç”¨å±‚](#åº”ç”¨å±‚)
      1.1 [è¡¨ç¤ºå±‚](#è¡¨ç¤ºå±‚)  
      1.2 [ä¼šè¯å±‚](#ä¼šè¯å±‚)
  2.[è¿è¾“å±‚](#è¿è¾“å±‚)
  3.[ç½‘ç»œå±‚](#ç½‘ç»œå±‚)
  4.[é“¾è·¯å±‚](#é“¾è·¯å±‚)
  5.[ç‰©ç†å±‚](#ç‰©ç†å±‚)



# å„ä¸ªå±‚çš„ç»“æ„

**åº”ç”¨å±‚**

**ä¼ è¾“å±‚**

<img src="image/udpdata1.png" style="zoom:30%;float:left">
<img src="image/tcpstruct.png" style="zoom:30%float:right">

â€‹	**ç½‘ç»œå±‚**

<img src="image/network/ipdatastruct.png">






## åº”ç”¨å±‚ application
åº”ç”¨å±‚çš„æ•°æ®å«:message æŠ¥æ–‡

ä¸ºäººç±»ç”¨æˆ·æˆ–è€…å…¶ä»–é¥®ç”¨è¿›ç¨‹æä¾›ç½‘ç»œåº”ç”¨æœåŠ¡
    åè®®:
        FTP:
        SMTP:
        HTTP:
        DNS:
        å¸¸è§çš„åè®®æœ‰æ•°ç™¾ç§







## è¡¨ç¤ºå±‚
å…è®¸é¥®ç”¨è§£é‡Šä¼ è¾“çš„æ•°æ®ï¼ŒåŠ å¯†ï¼Œå‹ç¼©ï¼Œæœºå™¨ç›¸å…³çš„çš„è¡¨ç¤ºè½¬æ¢

## ä¼šè¯å±‚
å»ºç«‹session,ç»´æŒsession
    




## è¿è¾“å±‚ transport
è¿è¾“å±‚çš„æ•°æ®å«:	segment æŠ¥æ–‡æ®µ

æ¯æ®µéƒ½ä¼šåŠ ä¸Šæ®µå¤´

åŒºåˆ†è¿›ç¨‹,åŠ å¼ºç½‘ç»œå±‚æä¾›çš„æœåŠ¡ï¼ŒæŠŠä¸å¯é å˜å¯é 
    åè®®:
        TCP:
        UDP:






## ç½‘ç»œå±‚ network
ç½‘ç»œå±‚çš„æ•°æ®å«ï¼šTCP(packet)	å«åˆ†ç»„

â€‹								UPD(datagram) æ•°æ®æŠ¥

ä¸»æœºåˆ°ä¸»æœºç«¯å¯¹ç«¯çš„æœåŠ¡,åŠ ä¸ŠæºIPç›®æ ‡IP
    åè®®: 
        IP(è½¬å‘ï¼Œä»ç«¯å£æ¥ï¼Œä»å“ªä¸ªç«¯å£èµ°)
        è·¯ç”±åè®®(è·¯ç”±é€‰æ‹©)





## é“¾è·¯å±‚ link
é“¾è·¯å±‚çš„æ•°æ®å«ï¼šframe å¸§

ç»™ç½‘ç»œå±‚çš„æ•°æ®æŠ¥åˆ†ç»„ï¼ŒåŠ ä¸Šé“¾è·¯å±‚çš„å¤´éƒ¨å’Œå°¾éƒ¨ï¼Œç»„æˆå¸§ äº¤ç»™ç‰©ç†å±‚

ç›¸é‚»ä¸¤ç‚¹ä¹‹é—´ä»¥ä¸ºå¸§ï¼ˆframeï¼‰ä¸ºå•ä½çš„æ•°æ®ä¼ è¾“
    åè®®:
        ç‚¹å¯¹å¯¹åè®®PPP
        802.11(WIFI)
        Ethernet



## ç‰©ç†å±‚ physiacal

åœ¨çº¿è·¯ä¸Šä¼ è¾“Bit
    åè®®: 



é“¾è·¯å±‚å’Œç‰©ç†å±‚ä¸€èˆ¬å°è£…åœ¨ä¸€å¼ ç½‘å¡ä¸Š

è·¯ç”±å™¨ä¸Šæœ‰å¤šä¸ªç½‘å¡ï¼Œæ¯ä¸ªç½‘å¡æ¥æ”¶åˆ°5å±‚çš„ä¿¡æ¯ï¼Œæ‹¨å¼€æœ€ä¸‹é¢ä¸¤å±‚ã€‚åˆ†ææºipå’Œç›®æ ‡Ipï¼Œç„¶åå°è£…é“¾è·¯å±‚å’Œç‰©ç†å±‚ã€‚äº¤ç»™ä¸‹ä¸€ä¸ªç½‘å¡ï¼Œç½‘å¡ç”±1010ç­‰ä¿¡å·è½¬æ¢æˆç”µç£æ³¢ä¿¡å·

# image

<img src="image/level.png" style="zoom:80%">

## æŠ“åŒ…

ğŸ˜Š**ç½‘å¡ï¼šPC(6ä½)å’Œè·¯ç”±å™¨çš„MACåœ°å€ï¼ˆ6ä½ï¼‰ + 2ä½çš„ipv4 æ ‡è¯† 0x0800   ä¸€å…±14å­—èŠ‚**

PC 6ä½ è·¯ç”±å™¨6ä½ (å‰ä¸‰ä½æœ‰æ©ç ) 

ğŸ˜Š**ç½‘ç»œåè®®4:																								-ä¸€å…±20å­—èŠ‚**  (ç½‘å¡+ç½‘ç»œåè®®4 å¾—34å­—èŠ‚)

version 4ä½ (åŠä¸ªchar) 												0.5å­—èŠ‚

header lenght 4 ä½ (åŠä¸ªchar) 										0.5å­—èŠ‚

differentiated serivice field 											1å­—èŠ‚

Total length  :1short 														2å­—èŠ‚

identification:è¯†åˆ« 1 short											 2å­—èŠ‚



dontâ€˜t fragment ä¸è¦ç¢è£‚ ï¼š			3bit

fragment offset ï¼šç‰‡æ®µåç§»			13bit å’Œä¸Šé¢ä¸€å…± 2å­—èŠ‚

timeTolive TTL																	1å­—èŠ‚

protocol åè®®	ç€ä¸Šé¢æ€ä¹ˆæ˜¾ç¤º6									1å­—èŠ‚

header checksum ï¼šå¤´éƒ¨æ ‡å¤´æ ¡éªŒå’Œ                			2å­—èŠ‚			

Source IP:																		4å­—èŠ‚

Destination ip:																4å­—èŠ‚



<img src="image/tcpstruct.png" style="float:left">

ğŸ˜Š**ä¼ è¾“å±‚ï¼šä¼ è¾“æ§åˆ¶åè®®                æ˜¾ç¤ºæœ‰32å­—èŠ‚**

 Source Port:ç«¯å£												2å­—èŠ‚

 Destination Port: 59611									2å­—èŠ‚



{sequence number (raw) åºåˆ—å·								4ä½

}

{Acknowledgment number (raw)  ç¡®è®¤ç¼–å·	4ä½



}

header  leaderï¼š													1å­—èŠ‚

{flags 																	1å­—èŠ‚

æ¯ä¸ªä½éƒ½æœ‰æ„ä¹‰

}

{ ä¸çŸ¥é“ä»€ä¹ˆç»“æ„												 2ä¸ªå­—èŠ‚

Window

window size scaling factor

calculated window size

}

Checksum  :æ ¡éªŒå’Œ													2å­—èŠ‚

urgen pointerï¼š ç´§æ€¥æŒ‡é’ˆ                           			2å­—èŠ‚



TCP option{															æœ€å12ä¸ªå­—èŠ‚

TCP option:					1å­—èŠ‚

TCP optionï¼š					1å­—èŠ‚

TCP æ—¶é—´æˆ³ï¼š{	first Frame in this Tcp stream					5å­—èŠ‚/10å­—èŠ‚

â€‹							Time since previous frame in this TCP stream 	5å­—èŠ‚

â€‹							}					

}





åº”ç”¨å±‚ ï¼šdata 27å­—èŠ‚









```text
Frame 23857: 93 bytes on wire (744 bits), 93 bytes captured (744 bits) on interface en0, id 0
Ethernet II, Src: ASUSTekC_60:86:2f (74:d0:2b:60:86:2f), Dst: Apple_8e:1d:ec (f0:18:98:8e:1d:ec)
    Destination: Apple_8e:1d:ec (f0:18:98:8e:1d:ec)
        Address: Apple_8e:1d:ec (f0:18:98:8e:1d:ec)
        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
    Source: ASUSTekC_60:86:2f (74:d0:2b:60:86:2f)
        Address: ASUSTekC_60:86:2f (74:d0:2b:60:86:2f)
        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
    Type: IPv4 (0x0800)
Internet Protocol Version 4, Src: 18.141.71.65, Dst: 192.168.2.66
Transmission Control Protocol, Src Port: 7716, Dst Port: 59611, Seq: 28, Ack: 43, Len: 27
    Source Port: 7716
    Destination Port: 59611
    [Stream index: 1276]
    [Conversation completeness: Incomplete, DATA (15)]
    [TCP Segment Len: 27]
    Sequence Number: 28    (relative sequence number)
    Sequence Number (raw): 4038411978
    [Next Sequence Number: 55    (relative sequence number)]
    Acknowledgment Number: 43    (relative ack number)
    Acknowledgment number (raw): 1398968734
    1000 .... = Header Length: 32 bytes (8)
    Flags: 0x018 (PSH, ACK)

           0. .... .... = Reserved: Not set
                      ...0 .... .... = Accurate ECN: Not set
                      .... 0... .... = Congestion Window Reduced: Not set
                      .... .0.. .... = ECN-Echo: Not set
                      .... ..0. .... = Urgent: Not set
                      .... ...1 .... = Acknowledgment: Set
                      .... .... 1... = Push: Set
                      .... .... .0.. = Reset: Not set
                      .... .... ..0. = Syn: Not set
                      .... .... ...0 = Fin: Not set
                      [TCP Flags: Â·Â·Â·Â·Â·Â·Â·APÂ·Â·Â·]
                  Window: 490
                  [Calculated window size: 62720]
                  [Window size scaling factor: 128]
                  Checksum: 0xb280 [unverified]
                  [Checksum Status: Unverified]
                  Urgent Pointer: 0
                  Options: (12 bytes), No-Op eration (NOP), No-Operation (NOP), Timestamps
                      TCP Option - No-Operation (NOP)
                      TCP Option - No-Operation (NOP)
                      TCP Option - Timestamps
                          Kind: Time Stamp Option (8)
                          Length: 10
                          Timestamp value: 3037130281: TSval 3037130281, TSecr 138655633
                          Timestamp echo reply: 138655633
                  [Timestamps]
                      [Time since first frame in this TCP stream: 70.564376000 seconds]
                      [Time since previous frame in this TCP stream: 0.108854000 seconds]
                  [SEQ/ACK analysis]
                      [This is an ACK to the segment in frame: 23853]
                      [The RTT to ACK the segment was: 0.108854000 seconds]
                      [iRTT: 0.098251000 seconds]
                      [Bytes in flight: 27]
                      [Bytes sent since last PSH flag: 27]
                  TCP payload (27 bytes)
              Data (27 bytes)
                  Data: 5365727669636520676f7420746865206d6573736167652e2e0a00
                  [Length: 27]
```

           0. 

```
```

## é€šä¿¡ä¹‹å‰ä¸‰æ¬¡äº¤äº’

1.src  TO des ï¼šç½‘å¡  14bit + åè®®å±‚  20 bit + ç½‘ç»œå±‚ 44 bit        78å­—èŠ‚

2.des  to src:ï¼šç½‘å¡  14bit + åè®®å±‚  20 bit + ç½‘ç»œå±‚ 40 bit        74å­—èŠ‚

3.src  TO des ï¼šç½‘å¡  14bit + åè®®å±‚  20 bit + ç½‘ç»œå±‚ 32 bit        66å­—èŠ‚

æŒ¥æ‰‹å®Œæ¯•

4 src  to des:	ç½‘å¡  14bit + åè®®å±‚  20 bit + ç½‘ç»œå±‚ 32 bit        66å­—èŠ‚   + data  







## ç¡¬ä»¶åœ°å€ NAT å’Œarpè¡¨æ˜¯ä»€ä¹ˆå…³ç³»

NAT "Network Address Translation"

ç¡¬ä»¶åœ°å€ã€NATå’ŒARPè¡¨æ˜¯IPç½‘ç»œä¸­ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µã€‚

**ç¡¬ä»¶åœ°å€**ï¼Œä¹Ÿç§°ä¸ºMACåœ°å€ï¼Œæ˜¯ç”¨æ¥æ ‡è¯†ç½‘ç»œè®¾å¤‡åœ¨æ•°æ®é“¾è·¯å±‚çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚

**NAT**ï¼Œå³ç½‘ç»œåœ°å€è½¬æ¢ï¼Œæ˜¯ç”¨äºè§£å†³IPåœ°å€ä¸è¶³é—®é¢˜çš„æŠ€æœ¯ã€‚NATé€šè¿‡å°†å†…éƒ¨ç½‘ç»œçš„ç§æœ‰IPåœ°å€è½¬æ¢ä¸ºå¤–éƒ¨ç½‘ç»œçš„å…¬æœ‰IPåœ°å€ï¼Œå®ç°å†…éƒ¨ç½‘ç»œä¸å¤–éƒ¨ç½‘ç»œçš„é€šä¿¡ã€‚

**ARPè¡¨**ï¼Œå³åœ°å€è§£æåè®®è¡¨ï¼Œæ˜¯ç”¨äºå­˜å‚¨IPåœ°å€å’ŒMACåœ°å€æ˜ å°„å…³ç³»çš„è¡¨ã€‚

**ç¡¬ä»¶åœ°å€ã€NATå’ŒARPè¡¨çš„å…³ç³»**å¦‚ä¸‹ï¼š

- **ç¡¬ä»¶åœ°å€æ˜¯ç”¨æ¥æ ‡è¯†ç½‘ç»œè®¾å¤‡çš„ï¼Œè€ŒNATå’ŒARPè¡¨æ˜¯ç”¨æ¥è§£æIPåœ°å€å’ŒMACåœ°å€çš„ã€‚**
- **NATå¯ä»¥å°†å†…éƒ¨ç½‘ç»œçš„ç§æœ‰IPåœ°å€è½¬æ¢ä¸ºå¤–éƒ¨ç½‘ç»œçš„å…¬æœ‰IPåœ°å€ï¼Œè€ŒARPè¡¨å¯ä»¥æ ¹æ®IPåœ°å€æŸ¥æ‰¾MACåœ°å€ã€‚**
- **åœ¨ä½¿ç”¨NATçš„æƒ…å†µä¸‹ï¼ŒARPè¡¨ä¸­ä¼šä¿å­˜å†…éƒ¨ç½‘ç»œçš„ç§æœ‰IPåœ°å€å’ŒNATè®¾å¤‡çš„å…¬æœ‰IPåœ°å€çš„æ˜ å°„å…³ç³»ã€‚**

ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªä½¿ç”¨NATçš„å±€åŸŸç½‘ä¸­ï¼Œæœ‰ä¸€å°ä¸»æœºçš„IPåœ°å€ä¸º192.168.1.1ï¼ŒMACåœ°å€ä¸º00:00:00:00:00:01ã€‚å½“è¿™å°ä¸»æœºå‘å¤–éƒ¨ç½‘ç»œå‘é€æ•°æ®åŒ…æ—¶ï¼ŒNATè®¾å¤‡ä¼šå°†IPåœ°å€192.168.1.1è½¬æ¢ä¸ºå…¬æœ‰IPåœ°å€192.168.1.2ã€‚åœ¨ARPè¡¨ä¸­ï¼Œä¼šä¿å­˜ä¸€æ¡æ˜ å°„å…³ç³»ï¼Œå³IPåœ°å€192.168.1.1å¯¹åº”MACåœ°å€00:00:00:00:00:01å’Œå…¬æœ‰IPåœ°å€192.168.1.2ã€‚

å½“å¤–éƒ¨ç½‘ç»œçš„ä¸»æœºå‘å±€åŸŸç½‘ä¸­çš„ä¸»æœºå‘é€æ•°æ®åŒ…æ—¶ï¼Œå¤–éƒ¨ç½‘ç»œçš„ä¸»æœºä¼šå°†æ•°æ®åŒ…å‘é€åˆ°NATè®¾å¤‡ã€‚NATè®¾å¤‡ä¼šæ ¹æ®æ•°æ®åŒ…çš„ç›®çš„IPåœ°å€æŸ¥æ‰¾ARPè¡¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„MACåœ°å€ï¼Œç„¶åå°†æ•°æ®åŒ…è½¬å‘ç»™å±€åŸŸç½‘ä¸­çš„ä¸»æœºã€‚

å› æ­¤ï¼Œç¡¬ä»¶åœ°å€ã€NATå’ŒARPè¡¨æ˜¯ç›¸äº’è”ç³»çš„ï¼Œå…±åŒå®ç°äº†IPç½‘ç»œä¸­çš„é€šä¿¡ã€‚



## ç«¯å£æ˜¯ä»€ä¹ˆæ„æ€ï¼Œç›®çš„æ˜¯åˆ†è¾¨è¿›ç¨‹å—

ç«¯å£æ˜¯æŒ‡è®¡ç®—æœºåœ¨ç½‘ç»œä¸­çš„ä¸€ä¸ªé€»è¾‘æ¥å£ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„åº”ç”¨ç¨‹åºæˆ–è¿›ç¨‹ã€‚ç«¯å£å·æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒèŒƒå›´ä» 0 åˆ° 65535ã€‚æ¯ä¸ªç«¯å£å·éƒ½å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨ç¨‹åºæˆ–è¿›ç¨‹ã€‚

ç«¯å£çš„ç›®çš„æ˜¯ä¸ºäº†åˆ†è¾¨è¿›ç¨‹ï¼Œä½¿ä¸åŒçš„è¿›ç¨‹èƒ½å¤Ÿåœ¨åŒä¸€å°è®¡ç®—æœºä¸ŠåŒæ—¶è¿è¡Œï¼Œå¹¶é€šè¿‡ç½‘ç»œä¸å…¶ä»–è®¡ç®—æœºè¿›è¡Œé€šä¿¡ã€‚

ä¾‹å¦‚ï¼ŒWeb æœåŠ¡å™¨é€šå¸¸ä½¿ç”¨ 80 ç«¯å£æ¥æä¾› HTTP æœåŠ¡ã€‚å½“ç”¨æˆ·è®¿é—®ä¸€ä¸ª Web ç«™ç‚¹æ—¶ï¼Œæµè§ˆå™¨ä¼šå‘ Web æœåŠ¡å™¨å‘é€ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œè¯·æ±‚æœåŠ¡å™¨è¿”å›ç½‘é¡µã€‚Web æœåŠ¡å™¨ä¼šåœ¨ 80 ç«¯å£ä¸Šæ¥æ”¶ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨åŒä¸€ä¸ªç«¯å£ä¸Šè¿”å›ç½‘é¡µã€‚

ç«¯å£è¿˜å¯ä»¥ç”¨äºå®‰å…¨æ§åˆ¶ã€‚ä¾‹å¦‚ï¼Œé˜²ç«å¢™å¯ä»¥æ ¹æ®ç«¯å£å·æ¥é™åˆ¶å¯¹ç‰¹å®šåº”ç”¨ç¨‹åºæˆ–æœåŠ¡çš„è®¿é—®ã€‚

å› æ­¤ï¼Œç«¯å£çš„ä½œç”¨ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š

- **åŒºåˆ†è¿›ç¨‹**ï¼šç«¯å£å·ç”¨äºåŒºåˆ†ä¸åŒçš„è¿›ç¨‹ï¼Œä½¿ä¸åŒçš„è¿›ç¨‹èƒ½å¤Ÿåœ¨åŒä¸€å°è®¡ç®—æœºä¸ŠåŒæ—¶è¿è¡Œã€‚
- **æä¾›ç½‘ç»œæœåŠ¡**ï¼šä¸åŒçš„ç«¯å£å·å¯¹åº”ä¸åŒçš„ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚ HTTPã€HTTPSã€FTPã€SMTP ç­‰ã€‚
- **å®‰å…¨æ§åˆ¶**ï¼šé˜²ç«å¢™å¯ä»¥æ ¹æ®ç«¯å£å·æ¥é™åˆ¶å¯¹ç‰¹å®šåº”ç”¨ç¨‹åºæˆ–æœåŠ¡çš„è®¿é—®ã€‚

ç«¯å£å·æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œåœ¨è®¡ç®—æœºç½‘ç»œä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚





# bps , Mbps ,Bps



**100 bps	è¡¨ç¤º100ä¸ªbit per second**

**100 Bps       è¡¨ç¤º100å­—èŠ‚(Byte)  per second**





100 M bps æ˜¯ 100 Megabits per second çš„ç¼©å†™ï¼Œè¡¨ç¤ºæ¯ç§’ä¼ è¾“çš„å…†ä½æ•°ã€‚

**1 Megabit ç­‰äº 10^6 bits**ï¼Œå› æ­¤ 100 M bps ç­‰äºæ¯ç§’ä¼ è¾“ 10^8 bits çš„æ•°æ®ã€‚



1Bps = 1å­—èŠ‚(Byte)   per second



